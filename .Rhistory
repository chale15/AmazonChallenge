ggplot(df, aes(x = x, y = y, color = as.factor(gamma))) +
geom_line(lwd = 2.5) +
scale_color_manual(values = c("cornflowerblue", "grey79")) +
labs(title = "Gamma Distribution for Different Shape Parameters",
x = "x",
y = "Density",
color = "Shape Parameter (" + str(expression(gamma))+")") +
theme_minimal()
phi <- 3
gamma_vals <- c(2, 10)
x <- seq(0, 60, by = 0.01)
df <- data.frame(
x = rep(x, length(gamma_vals)),
y = unlist(lapply(gamma_vals, function(g) dgamma(x, shape = g, scale = phi))),
gamma = rep(gamma_vals, each = length(x))
)
ggplot(df, aes(x = x, y = y, color = as.factor(gamma))) +
geom_line(lwd = 2.5) +
scale_color_manual(values = c("cornflowerblue", "grey79")) +
labs(title = "Gamma Distribution for Different Shape Parameters",
x = "x",
y = "Density",
color = "Shape Parameter (" + expression(gamma)+")") +
theme_minimal()
phi <- 3
gamma_vals <- c(2, 10)
x <- seq(0, 60, by = 0.01)
df <- data.frame(
x = rep(x, length(gamma_vals)),
y = unlist(lapply(gamma_vals, function(g) dgamma(x, shape = g, scale = phi))),
gamma = rep(gamma_vals, each = length(x))
)
ggplot(df, aes(x = x, y = y, color = as.factor(gamma))) +
geom_line(lwd = 2.5) +
scale_color_manual(values = c("cornflowerblue", "grey79")) +
labs(title = "Gamma Distribution for Different Shape Parameters",
x = "x",
y = "Density",
color = expression(gamma)) +
theme_minimal()
phi_vals <- c(2, 8)
gamma <- 5
x <- seq(0, 60, by = 0.01)
df <- data.frame(
x = rep(x, length(phi_vals)),
y = unlist(lapply(phi_vals, function(p) dgamma(x, shape = gamma, scale = p))),
phi1 = rep(phi_vals, each = length(x))
)
ggplot(df, aes(x = x, y = y, color = as.factor(phi1))) +
geom_line(lwd = 2.5) +
scale_color_manual(values = c("cornflowerblue", "grey79")) +
labs(title = "Gamma Distribution for Different Rate Parameters",
x = "x",
y = "Density",
color = expression(phi)) +
theme_minimal()
phi_vals <- c(2, 8)
gamma <- 5
x <- seq(0, 60, by = 0.01)
df <- data.frame(
x = rep(x, length(phi_vals)),
y = unlist(lapply(phi_vals, function(p) dgamma(x, shape = gamma, scale = p))),
phi1 = rep(phi_vals, each = length(x))
)
ggplot(df, aes(x = x, y = y, color = as.factor(phi1))) +
geom_line(lwd = 2.5) +
scale_color_manual(values = c("cornflowerblue", "grey79")) +
labs(title = "Gamma Distribution for Different Rate Parameters",
x = "x",
y = "Density",
color = expression(phi)) +
theme_minimal()
library('kknn')
library(tidyverse)
library(tidymodels)
library(embed)
library(vroom)
library(workflows)
library(glmnet)
setwd("~/Desktop/Fall 2024/Stat 348/GitHubRepos/amazon-employee-access-challenge/")
train <- vroom("train.csv")
test <- vroom("test.csv")
train <- train %>% mutate(ACTION = as.factor(ACTION))
my_recipe <- recipe(ACTION~., data = train) %>%
step_mutate_at(all_numeric_predictors(), fn = factor) %>%
step_lencode_mixed(all_nominal_predictors(), outcome = vars(ACTION)) %>%
step_normalize(all_numeric_predictors())
knn_model <- nearest_neighbor(neighbors=tune()) %>%
set_mode("classification")
set_engine('kknn')
set_engine("kknn")
set_engine("knn")
knn_model <- nearest_neighbor(neighbors=tune()) %>%
set_mode("classification") %>%
set_engine("kknn")
knn_workflow <- workflow() %>%
add_model(knn_model) %>%
add_recipe(my_recipe)
tuning_grid <- grid_regular(neighbors(), levels = 100)
folds <- vfold_cv(train, v = 10, repeats=1)
cv_results <- knn_workflow %>%
tune_grid(resamples = folds,
grid = tuning_grid,
metrics = metric_set(roc_auc))
install.packages('kknn')
library(kknn)
cv_results <- knn_workflow %>%
tune_grid(resamples = folds,
grid = tuning_grid,
metrics = metric_set(roc_auc))
tuning_grid <- grid_regular(neighbors(), levels = 10)
folds <- vfold_cv(train, v = 10, repeats=1)
cv_results <- knn_workflow %>%
tune_grid(resamples = folds,
grid = tuning_grid,
metrics = metric_set(roc_auc))
best_tune <- cv_results %>% select_best(metric='roc_auc')
final_workflow <- plog_workflow %>%
finalize_workflow(best_tune) %>%
fit(data = train)
final_workflow <- knn_workflow %>%
finalize_workflow(best_tune) %>%
fit(data = train)
knn_preds <- predict(final_workflow,
new_data = test,
type = 'prob')
knn_submission <- knn_preds %>%
bind_cols(., test) %>%
select(id, .pred_1) %>%
rename(ACTION = .pred_1)
vroom_write(x=knn_submission, file="./Submissions/KNNPreds1.csv", delim=",")
prior_vals <- c(0.5, 3)
x <- seq(0, 60, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y, color = "cornflowerblue")) +
geom_line(lwd = 2.5) +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 5, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y, color = "cornflowerblue")) +
geom_line(lwd = 2.5) +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 2, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y, color = "cornflowerblue")) +
geom_line(lwd = 2.5) +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 2, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 1.1, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 1.5, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 1, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = paste0("Beta Distribution for ",expression(alpha),"= 0.5, ", expression(beta),"=3"),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 1, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = expression(paste0("Beta Distribution for ",alpha,"= 0.5, ", beta,"=3")),
x = "x",
y = "Density") +
theme_minimal()
prior_vals <- c(0.5, 3)
x <- seq(0, 1, by = 0.01)
df_beta <- data.frame(
x = x,
y = dbeta(x, prior_vals[1], prior_vals[2]))
ggplot(df_beta, aes(x = x, y = y)) +
geom_line(lwd = 2.5, color = "cornflowerblue") +
labs(title = expression(paste("Beta Distribution for ",alpha,"= 0.5, ", beta,"=3")),
x = "x",
y = "Density") +
theme_minimal()
.5/3.5
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
post_male <- c(0.5+67, 3+(1260-67))
post_female <- c(0.5+173, 3+(1700-173))
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male),lwd = 2.5, color = "cornflowerblue") +
geom_line(aes(y = female),lwd = 2.5, color = "firebrick") +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")
theme_minimal()
df_beta_post <- data.frame(
x = seq(0, 0.25, by = 0.001)),
df_beta_post <- data.frame(
x = seq(0, 0.25, by = 0.001),
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
df_beta_post <- data.frame(
x = seq(0, 0.25, by = 0.004),
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
x <- seq(0, 0.25, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male),lwd = 2.5, color = "cornflowerblue") +
geom_line(aes(y = female),lwd = 2.5, color = "firebrick") +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
theme_minimal()
x <- seq(0, 0.25, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male),lwd = 2.5, color = "Male") +
geom_line(aes(y = female),lwd = 2.5, color = "Female") +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))
x <- seq(0, 0.25, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))
theme_minimal()
x <- seq(0, 0.25, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))+
theme_minimal()
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))+
theme_minimal()
t.test(df_beta_post$male, df_beta_post$female)
male_draws <- rbeta(1000, post_male[1], post_male[2])
female_draws <- rbeta(1000, post_female[1], post_female[2])
t.test(male_draws, female_draws)
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]),
diff = dbeta(x, post_female[1], post_female[2]) - dbeta(x, post_male[1], post_male[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
geom_line(aes(y = diff, color = "Difference"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick", "Difference" = "grey79"))+
theme_minimal()
lambda.lynx <- rgamma(10000, gamma.lynx.p, phi.lynx.p)
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]),
diff = rbeta(length(x), post_female[1], post_female[2]) - rbeta(length(x), post_male[1], post_male[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
geom_line(aes(y = diff, color = "Difference"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick", "Difference" = "grey79"))+
theme_minimal()
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]),
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(10000, post_male[1], post_male[2]))
x <- seq(0, 0.15, length.out = 10000)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]),
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(10000, post_male[1], post_male[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
geom_line(aes(y = diff, color = "Difference"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick", "Difference" = "grey79"))+
theme_minimal()
x <- seq(0, 0.15, length.out = 10000)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]),
diff = rbeta(x, post_female[1], post_female[2]) - rbeta(x, post_male[1], post_male[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
geom_line(aes(y = diff, color = "Difference"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick", "Difference" = "grey79"))+
theme_minimal()
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
geom_line(aes(y = diff, color = "Difference"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick", "Difference" = "grey79"))+
theme_minimal()
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = "Posterior Distribution of Male and Female Questions Skipped",
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))+
theme_minimal()
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
plot(density(diff))
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
ggplot(aes(y = diff)) +
geom_density()
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
ggplot(data = diff, aes(y = diff)) +
geom_density()
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
ggplot() +
geom_density(y = diff)
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
df_diff <- data.frame(diff = diff)
# Plot using ggplot
ggplot(df_diff, aes(x = diff)) +
geom_density(fill = "lightblue", color = "blue", alpha = 0.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
labs(x = expression(theta[F] - theta[M]),
y = "Density",
title = expression(paste("Posterior Distribution of ", theta[F] - theta[M]))) +
theme_minimal(base_size = 15)
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
df_diff <- data.frame(diff = diff)
# Plot using ggplot
ggplot(df_diff, aes(x = diff)) +
geom_density(fill = "skyblue", color = "skyblue", alpha = 0.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
labs(x = expression(theta[F] - theta[M]),
y = "Density",
title = expression(paste("Posterior Distribution of ", theta[F] - theta[M]))) +
theme_minimal(base_size = 15)
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
df_diff <- data.frame(diff = diff)
# Plot using ggplot
ggplot(df_diff, aes(x = diff)) +
geom_density(fill = "skyblue", color = "blue", alpha = 0.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
labs(x = expression(theta[F] - theta[M]),
y = "Density",
title = expression(paste("Posterior Distribution of ", theta[F] - theta[M]))) +
theme_minimal(base_size = 15)
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = expression(paste("Posterior Distribution of ", theta[F]," and ", theta[M])),
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "firebrick"))+
theme_minimal()
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
df_diff <- data.frame(diff = diff)
# Plot using ggplot
ggplot(df_diff, aes(x = diff)) +
geom_density(fill = "skyblue", color = "blue", alpha = 0.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
labs(x = expression(theta[F] - theta[M]),
y = "Density",
title = expression(paste("Posterior Distribution of ", theta[F] - theta[M]))) +
theme_minimal()
x <- seq(0, 0.15, by = 0.001)
df_beta_post <- data.frame(
x = x,
male = dbeta(x, post_male[1], post_male[2]),
female = dbeta(x, post_female[1], post_female[2]))
diff = rbeta(10000, post_female[1], post_female[2]) - rbeta(1000, post_male[1], post_male[2])
df_diff <- data.frame(diff = diff)
ggplot(df_beta_post, aes(x = x)) +
geom_line(aes(y = male, color = "Male"),lwd = 2.5) +
geom_line(aes(y = female, color = "Female"),lwd = 2.5) +
labs(title = expression(paste("Posterior Distribution of ", theta[F]," and ", theta[M])),
x = "Proportion of Questions Skipped",
y = "Density",
color = "Gender")+
scale_color_manual(values = c("Male" = "cornflowerblue", "Female" = "grey79"))+
theme_minimal()
