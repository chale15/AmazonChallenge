likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals){
theta_vals <- c(0.2, 0.5, 0.8, 0.9)
theta_probs <- c(0.1, 0.2, 0.3, 0.4)
y_1 <- 45
likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals)){
likelihoods[i] = dnbinom(y_1, size = 20, prob = theta_vals[i])
}
print(likelihoods)
theta_vals <- c(0.2, 0.5, 0.8, 0.9)
theta_probs <- c(0.1, 0.2, 0.3, 0.4)
y_1 <- 45
likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals)){
likelihoods[i] = dnbinom(y_1, size = 20, prob = theta_vals[i])
print(paste0("Likelihood for Theta = ", theta_vals[i], " is:   ", likelihoods[i]))
}
theta_vals <- c(0.2, 0.5, 0.8, 0.9)
theta_probs <- c(0.1, 0.2, 0.3, 0.4)
y_1 <- 45
likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals)){
likelihoods[i] = dnbinom(y_1, size = 20, prob = theta_vals[i])
print(paste0("Likelihood for Theta = ", theta_vals[i], " is:   ", likelihoods[i]));
}
theta_vals <- c(0.2, 0.5, 0.8, 0.9)
theta_probs <- c(0.1, 0.2, 0.3, 0.4)
y_1 <- 45
likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals)){
likelihoods[i] = dnbinom(y_1, size = 20, prob = theta_vals[i])
print(paste0("Likelihood for Theta = ", theta_vals[i], " is:   ", likelihoods[i]))
}
plot(theta_vals, likelihoods)
theta_vals <- c(0.2, 0.5, 0.8, 0.9)
theta_probs <- c(0.1, 0.2, 0.3, 0.4)
y_1 <- 45
likelihoods <- rep(0, 4)
for (i in 1:length(theta_vals)){
likelihoods[i] = dnbinom(y_1, size = 20, prob = theta_vals[i])
print(paste0("Likelihood for Theta = ", theta_vals[i], " is:   ", likelihoods[i]))
}
#plot(theta_vals, likelihoods)
marginals <- rep(0, 4)
posteriors <- rep(0, 4)
joint <- likelihoods * theta_probs
joint <- likelihoods * theta_probs
marginal <- sum(joint)
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
sum(posteriors)
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
print(posteriors)
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
1-pbeta(0.2, 1, 3)
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
1-pbeta(0.25, 1, 3)
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
pbeta(0.2, 1, 3, lower.tail = FALSE)
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
prior_prob <- pbeta(0.2, 1, 3, lower.tail = FALSE)
alpha <- 1
beta <- 3
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
prior_prob <- pbeta(0.2, alpha, beta, lower.tail = FALSE)
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
prior_prob <- pbeta(0.2, alpha_prime, beta_prime, lower.tail = FALSE)
alpha_prime <- alpha + 7 #Observed Successes
beta_prime <- beta + (18 - 7) #Observed Failures
post_prob <- pbeta(0.2, alpha_prime, beta_prime, lower.tail = FALSE)
alpha <- 1
beta <- 3
prior_prob <- pbeta(0.2, alpha, beta, lower.tail = FALSE)
cred_int <- qbeta(c(.025, .975), alpha_prime, beta_prime)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
plot(x_draws)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
hist(x_draws)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
hist(x_draws, bins = 30)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
ggplot(aes(x = x_draws)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
ggplot(x_draws) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(1, n = 18, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(100000, n = 18, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(n = 18, 100000, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(n = 18, 1, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
rbinom(n = 18, 1, prob = 0.6)
rbinom(size = 18, 1, prob = 0.6)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(size = 18, 1, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
x_draws <- rbinom(size = 18, 1, prob = theta_draws)
x_draws_df <- data.frame(x = x_draws)
ggplot(x_draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, 1, prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
View(draws_df)
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 30, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 25, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.7) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Histogram of Binomial Draws", x = "Number of Successes", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Randomly Generated Theta Values", x = "Number of Successes (x)", y = "Frequency") +
theme_minimal()
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot_title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot_title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
mean(rbeta(100000, alpha, beta))
8/22
(0.57-.181)/2
(0.57+.181)/2
mean(draws_df$x)
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
table(as.matrix(tibble(theta_vals, posteriors)))
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
tibble(theta_vals, posteriors)
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
as.table(as.matrix(tibble(theta_vals, posteriors)))
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
as.table(as.matrix(tibble(round(theta_vals,2), posteriors)))
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
mat <- as.matrix(tibble(posteriors))
row.names(mat) <- theta_vals
as.table(mat)
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
mat <- as.matrix(tibble(posteriors))
row.names(mat) <- theta_vals
column.names(mat) <- c(expression(theta), 'Posterior')
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
mat <- as.matrix(tibble(posteriors))
rownames(mat) <- theta_vals
colnames(mat) <- c(expression(theta), 'Posterior')
joint <- likelihoods * theta_probs
marginal <- sum(joint)
posteriors <- joint/marginal
mat <- as.matrix(tibble(posteriors))
rownames(mat) <- theta_vals
as.table(mat)
plot(y = theta_probs,
x = theta_vals,
ylim = c(0, 1),
title('Prior and Posterior Probability'),
ylab = 'Probability', xlab = expression(theta),
pch = 19, col = 'cornflowerblue')
points(x = theta_vals, y = posteriors, col = 'forestgreen', pch = 17)
legend('topright', legend=c("Prior", "Posterior"), pch=c(19, 17),
col=c("cornflowerblue", "forestgreen"))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 19, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
theta_draws <- rbeta(100000, alpha_prime, beta_prime)
draws_df <- data.frame(theta_draws)
draws_df <- draws_df %>% mutate(x = rbinom(size = 18, n = n(), prob = theta_draws))
ggplot(draws_df, aes(x = x)) +
geom_histogram(bins = 18, color = "forestgreen", fill = "forestgreen", alpha = 0.6) +
labs(title = "Distribution of Binomial Draws from Posterior Theta Values",
x = "Number of Successes (x)",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
library(tidyverse)
library(tidymodels)
library(embed)
library(vroom)
library(workflows)
setwd("~/Desktop/Fall 2024/Stat 348/GitHubRepos/amazon-employee-access-challenge/")
train <- vroom("train.csv")
test <- vroom("test.csv")
my_recipe <- recipe(ACTION~., data = train) %>%
step_mutate_at(all_numeric_predictors(), fn = factor) %>%
step_other(all_nominal_predictors(), threshold = .001) %>%
step_dummy(all_nominal_predictors())
prepped <- prep(my_recipe)
log_reg_model <- logistic_reg() %>%
set_engine('glm')
log_reg_workflow <- workflow() %>%
add_model(log_reg_model) %>%
add_recipe(my_recipe)
log_reg_preds <- predict(log_reg_workflow,
new_data = test,
type = 'prob')
log_reg_workflow <- workflow() %>%
add_model(log_reg_model) %>%
add_recipe(my_recipe) %>%
fit(data = train)
View(train)
train <- train %>% mutate(ACTION = as.factor(ACTION))
my_recipe <- recipe(ACTION~., data = train) %>%
step_mutate_at(all_numeric_predictors(), fn = factor) %>%
step_other(all_nominal_predictors(), threshold = .001) %>%
step_dummy(all_nominal_predictors())
log_reg_model <- logistic_reg() %>%
set_engine('glm')
log_reg_workflow <- workflow() %>%
add_model(log_reg_model) %>%
add_recipe(my_recipe) %>%
fit(data = train)
View(test)
log_reg_preds <- predict(log_reg_workflow,
new_data = test,
type = 'prob')
log_reg_submission <- log_reg_preds %>%
bind_cols(., test) %>%
select(Id, .pred) %>%
rename(ACTION = .pred)
log_reg_submission <- log_reg_preds %>%
bind_cols(., test) %>%
select(id, .pred) %>%
rename(ACTION = .pred)
log_reg_submission <- log_reg_preds %>%
bind_cols(., test) %>%
select(id, .pred_1) %>%
rename(ACTION = .pred_1)
vroom_write(x=log_reg_submission, file="./Submissions/LogRegPreds1.csv", delim=",")
vroom_write(x=log_reg_submission, file="./LogRegPreds1.csv", delim=",")
